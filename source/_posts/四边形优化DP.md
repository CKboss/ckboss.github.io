title: 四边形优化DP
date: 2015-10-27 23:05:50
tags:
- DP

categories:
- acm_dp

---


# 四边形优化DP

在动态规划中，有这样的一类问题
状态转移方程:

$$dp[i][j]=min(dp[i][k-1]+dp[k][j])+w[i][j]  $$

时间复杂度为: $O(n^3)$
且有如下一些定义和定理：

* 如果一个函数w[i][j]，满足 w[a][c]+w[b][d]<=w[a][d]+w[b][c] a<=b<=c<=d 则称w满足凸四边形不等式

* 如果一个函数w[i][j]，满足 w[b][c]<=w[a][d]  a<=b<=c<=d 则称w关于区间包含关系单调

##### 定理1：如果w同时满足四边形不等式和区间单调关系，则dp也满足四边形不等式

##### 定理2：如果定理1条件满足时让dp[i][j]取最小值的k为K[i][j]，则K[i][j-1]<=K[i][j]<=K[i+1][j]

*注：定理2是四边形不等式优化的关键所在，它说明了决策具有单调性，然后我们可以据此来缩小决策枚举的区间，进行优化*

##### 定理3：w为凸当且仅当 w[i][j]+w[i+1][j+1]<=w[i+1][j]+w[i][j+1]

几点说明：
1：定理1的证明比较烦躁，详细的可以见《动态规划算法的优化技巧》毛子青 大神的论文

2：定理3其实告诉我们验证w是否为凸的方法，就是固定一个变量，然后看成是一个一元函数，进而判断单调性。
如，我们可以固定j算出w[i][j+1]-w[i][j]关于i的表达式，看它是关于i递增还是递减，如果是递减，则w为凸

3：实际操作中，我们往往并不需要进行烦躁的证明，而只需要打表，然后观察就行了
如w[i][j],dp[i][j]是否满足四边形不等式啊，w[i][j]是否单调啊，决策函数K[i][j]是否满足定理2的不等式关系啊，都可以通过打表来搞