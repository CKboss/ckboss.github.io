title: HDOJ 5431 AB String 暴力查找
date: 2015-09-14 11:14:39
tags:
- STL
categories:
- acm_字符串

---

记录每一个串的不同长度的子串,用set储存下来.

对于每个询问k,先找到是属于哪个长度的子串中,再到相应的set里取查找.

---

#### AB String

Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others)
Total Submission(s): 139    Accepted Submission(s): 42


##### Problem Description
Given a string S contains only A and B.

Calculate the Kth string T which doesn't appear in S.

Compare the string in order of length,if length is same,then sort in order of lexicographical order.
 
<!-- more -->

##### Input
First line contains a single integer cases(cases≤5) which denotes the number of test cases. 

For each test case, the first line is string S(1≤|S|≤20000), the second line have T+1 numbers,the first number is T,next T number(s) is Kth. (1≤T≤10,1≤K≤109)
 

##### Output
For each case, output T lines.
 
```
Sample Input
2
A
1 1
AAABBA
1 1
 

Sample Output
B
ABA
```

Source
BestCoder Round #54 (div.1) ($)
 

```c++
/* ***********************************************
Author        :CKboss
Created Time  :2015年09月14日 星期一 08时36分54秒
File Name     :HDOJ5431.cpp
************************************************ */

#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <string>
#include <cmath>
#include <cstdlib>
#include <vector>
#include <queue>
#include <set>
#include <map>

using namespace std;

const int maxn=200020;

typedef long long int LL;

set<LL> st[33];
LL n;
char str[maxn];
char ans[maxn];

void init() { for(LL i=0;i<33;i++) st[i].clear(); }

void gao(LL id,LL pos)
{
	set<LL>::iterator it=st[id].begin();
	set<LL>::iterator ed=st[id].end();
	memset(ans,0,sizeof(ans));

	LL last=-1;
	LL nb=-1;
	while(it!=ed)
	{
		LL kong=(*it)-last-1;

		if(pos<=kong)
		{
			nb=last+pos; break;
		}

		pos-=kong;
		last=(*it);
		it++;
	}

	if(nb==-1)
	{
		nb=last+pos;
	}
	for(LL i=id-1,j=0;i>=0;i--,j++)
	{
		if(nb&(1LL<<j)) ans[i]='B';
		else ans[i]='A';
	}
	
	printf("%s\n",ans);
}

int main()
{
    //freopen("in.txt","r",stdin);
    //freopen("out.txt","w",stdout);

	int T_T;
	scanf("%d",&T_T);
	while(T_T--)
	{
		memset(str,0,sizeof(str));
		init();
		scanf("%s",str);
		n=strlen(str);
		for(LL i=1;i<33;i++)
		{
			for(LL j=0;j+i-1<n;j++)
			{
				LL tmp=0;
				for(LL k=j;k<=j+i-1;k++)
				{
					if(str[k]=='B')
					{
						tmp|=(1LL<<(i-(k-j)-1));
					}
				}
				st[i].insert(tmp);
			}
		}
		int q;
		scanf("%d",&q);
		while(q--)
		{
			LL pos;
			scanf("%lld",&pos);
			for(LL i=1;i<33;i++)
			{
				if( pos <= ((1LL<<i)-st[i].size()) )
				{
					gao(i,pos); break;
				}
				else
				{
					pos-=((1LL<<i)-st[i].size());
				}
			}
		}
	}
    
    return 0;
}
```
