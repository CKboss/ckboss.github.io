title: HDOJ 4756 Install Air Conditioning 次小生成树

date: 2015-11-08 23:21:53

tags:
- 次小生成树

categories:
- acm_图论

---

简单次小生成树,根据题目需求计算即可.

# [Install Air Conditioning](http://acm.hdu.edu.cn/showproblem.php?pid=4756)

Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 65535/65535 K (Java/Others)
Total Submission(s): 1230    Accepted Submission(s): 288


##### Problem Description

![](http://acm.hdu.edu.cn/data/images/C479-1009-1.jpg)

  NJUST carries on the tradition of HaJunGong. NJUST, who keeps up the ”people-oriented, harmonious development” of the educational philosophy and develops the ”unity, dedication, truth-seeking, innovation” school motto, has now become an engineering-based, multidisciplinary university.

  As we all know, Nanjing is one of the four hottest cities in China. Students in NJUST find it hard to fall asleep during hot summer every year. They will never, however, suffer from that hot this year, which makes them really excited. NJUST’s 60th birthday is approaching, in the meantime, 50 million is spent to install air conditioning among students dormitories. Due to NJUST’s long history, the old circuits are not capable to carry heavy load, so it is necessary to set new high-load wires. To reduce cost, every wire between two dormitory is considered a segment. Now, known about all the location of dormitories and a power plant, and the cost of high-load wire per meter, Tom200 wants to know in advance, under the premise of all dormitories being able to supply electricity, the minimum cost be spent on high-load wires. And this is the minimum strategy. But Tom200 is informed that there are so many wires between two specific dormitories that we cannot set a new high-load wire between these two, otherwise it may have potential risks. The problem is that Tom200 doesn’t know exactly which two dormitories until the setting process is started. So according to the minimum strategy described above, how much cost at most you'll spend?


##### Input
  The first line of the input contains a single integer T(T ≤ 100), the number of test cases.
  For each case, the first line contains two integers n(3 ≤ n ≤ 1000), k(1 ≤ k ≤ 100). n represents n-1 dormitories and one power plant, k represents the cost of high-load wire per meter. n lines followed contains two integers x, y(0 ≤ x, y ≤ 10000000), representing the location of dormitory or power plant. Assume no two locations are the same, and no three locations are on a straight line. The first one is always the location of the power plant.


##### Output
  For each case, output the cost, correct to two decimal places.

```
Sample Input
2

4 2
0 0
1 1
2 0
3 1

4 3
0 0
1 1
1 0
0 1
 

Sample Output
9.66
9.00
```

##### Source
2013 ACM/ICPC Asia Regional Nanjing Online

<!-- more -->


```cpp
/* ***********************************************
Author        :CKboss
Created Time  :2015年11月08日 星期日 21时41分40秒
File Name     :HDOJ4756.cpp
************************************************ */

#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <string>
#include <cmath>
#include <cstdlib>
#include <vector>
#include <queue>
#include <set>
#include <map>

using namespace std;

const int maxn=1010;
const double inf=1e20;

struct Edge
{
    int to,next;
    double cost;
}edge[maxn*maxn*2];

int Adj[maxn],Size;

void init_edge()
{
    memset(Adj,-1,sizeof(Adj)); Size=0;
}

void Add_Edge(int u,int v,double cost)
{
    edge[Size].to=v;
    edge[Size].cost=cost;
    edge[Size].next=Adj[u];
    Adj[u]=Size++;
}

struct Point
{
    double x,y;
}pt[maxn];

int n;
double Valu;
double G[maxn][maxn];

double getDist(Point a,Point b)
{
    return sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y));
}

int pre[maxn];
bool vis[maxn];
double dist[maxn];

double Prime()
{
    for(int i=0;i<maxn;i++)
    {
        vis[i]=false;
        dist[i]=inf; pre[i]=i;
    }

    dist[0]=0;
    double sum=0;

    for(int i=0;i<n;i++)
    {
        int mark=-1;
        double mindist=inf;

        for(int j=0;j<n;j++)
        {
            if(!vis[j]&&dist[j]<mindist)
            {
                mindist=dist[j];
                mark=j;
            }
        }

        if(mark==-1) return inf;
        sum+=mindist; vis[mark]=true;

        for(int j=0;j<n;j++)
        {
            if(!vis[j]&&G[mark][j]<dist[j])
            {
                dist[j]=G[mark][j];
                pre[j]=mark;
            }
        }
    }

    init_edge();
    for(int i=0;i<n;i++)
    {
        if(i==pre[i]) continue;
        double L=G[i][pre[i]];
        Add_Edge(i,pre[i],L); Add_Edge(pre[i],i,L);
    }

    return sum;
}

double dp[maxn][maxn];

double dfs(int P,int u,int fa,int deep)
{
    double ret=inf;
    if(deep!=1) ret=G[u][P];

    for(int i=Adj[u];~i;i=edge[i].next)
    {
        int v=edge[i].to;
        if(v==fa) continue;

        double tt=dfs(P,v,u,deep+1);
        ret=min(ret,tt);

        dp[u][v]=dp[v][u]=min(dp[u][v],tt);
    }

    return ret;
}

void Pre_Gao()
{
    for(int i=0;i<=n;i++)
        for(int j=0;j<=n;j++)
            dp[i][j]=inf;

    for(int i=0;i<n;i++) dfs(i,i,-1,0);
}

int main()
{
    //freopen("in.txt","r",stdin);
    //freopen("out.txt","w",stdout);

    int T_T;
    scanf("%d",&T_T);
    while(T_T--)
    {
        scanf("%d%lf",&n,&Valu);
        for(int i=0;i<n;i++)
        {
            double x,y;
            scanf("%lf%lf",&x,&y);
            pt[i].x=x; pt[i].y=y;
        }
        for(int i=0;i<n;i++)
        {
            G[i][i]=inf;
            for(int j=i+1;j<n;j++)
            {
                G[i][j]=G[j][i]=getDist(pt[i],pt[j]);
            }
        }

        double mst=Prime();
        double deta=0;

        Pre_Gao();
        for(int u=0;u<n;u++)
        {
            for(int j=Adj[u];~j;j=edge[j].next)
            {
                int v=edge[j].to;
                if(v<u) continue;
                if(u==0||v==0) continue;
                deta=max(deta,dp[u][v]-G[u][v]);
            }
        }

        printf("%.2lf\n",(mst+deta)*Valu);
    }
    
    return 0;
}
```


