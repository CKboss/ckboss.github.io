title: ZOJ 2563 Long Dominoes 状压DP
date: 2015-10-29 00:00:01
tags:
- dp

categories:
- acm_dp

---

状压DP...

0表示对下面0行有影响的点,1表示对下面1行有影响的点,2表示对下面2行有影响的点.


## [Long Dominoes](http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemId=1563)
Time Limit: 2 Seconds      Memory Limit: 65536 KB
Find the number of ways to tile an m*n rectangle with long dominoes -- 3*1 rectangles.

Each domino must be completely within the rectangle, dominoes must not overlap (of course, they may touch each other), each point of the rectangle must be covered.


##### Input

The input contains several cases. Each case stands two integers m and n (1 <= m <= 9, 1 <= n <= 30) in a single line. The input ends up with a case of m = n = 0.


##### Output

Output the number of ways to tile an m*n rectangle with long dominoes.

```
Sample Input

3 3
3 10
0 0

Sample Output

2
28
```

Author: Andrew Stankevich
Source: Andrew Stankevich's Contest #4

<!--more-->

```cpp
/* ***********************************************
Author        :CKboss
Created Time  :2015年10月28日 星期三 22时18分34秒
File Name     :ZOJ2563.cpp
************************************************ */

#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <string>
#include <cmath>
#include <cstdlib>
#include <vector>
#include <queue>
#include <set>
#include <map>

using namespace std;

typedef long long int LL;

LL p9[11];
/// 行,状态
LL dp[33][20000];
int m,n;

void init()
{
    p9[0]=1LL;
    for(int i=1;i<=10;i++) p9[i]=p9[i-1]*3;
}

int row,st;
int num[10];

void fj(int ttt)
{
    memset(num,0,sizeof(num));
    for(int i=0;i<n;i++)
    {
        num[i]=ttt%3;
        ttt/=3;
    }
}

void dfs(int pos,LL state)
{
    if(pos==n)
    {
        dp[row][state]+=dp[row-1][st];
        return ;
    }
    if(num[pos]==0)
    {
        if(pos+2<n&&num[pos+1]==0&&num[pos+2]==0) dfs(pos+3,state);
        dfs(pos+1,state+2*p9[pos]);
    }
    else if(num[pos]==1)
    {
        dfs(pos+1,state);
    }
    else if(num[pos]==2)
    {
        dfs(pos+1,state+p9[pos]);
    }
}

int main()
{
    //freopen("in.txt","r",stdin);
    //freopen("out.txt","w",stdout);

    init();
    while(scanf("%d%d",&m,&n)!=EOF)
    {
        if(m<n) swap(n,m);
        if(m==0&&n==0) break;
        if((n*m)%3!=0) { puts("0"); continue; }

        int mx=p9[n];
        memset(dp,0,sizeof(dp));
        dp[0][0]=1;
        for(row=1;row<=m;row++)
        {
            for(st=0;st<mx;st++)
            {
                fj(st);
                dfs(0,0);
            }
        }

        printf("%lld\n",dp[m][0]);
    }
    
    return 0;
}
```

